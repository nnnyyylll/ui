{"ast":null,"code":"var _jsxFileName = \"D:\\\\Users\\\\lynnlam\\\\Documents\\\\GitHub\\\\ui\\\\world\\\\src\\\\App.js\";\nimport React from \"react\";\nimport parse from \"papaparse\";\nimport { useState } from 'react';\nimport * as XLSX from 'xlsx';\nimport moment from \"moment\";\nimport ReactDOM from 'react-dom';\nimport { Button, Table, Upload, Icon } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  onFileChange = e => {\n    const {\n      tableOnImportItems\n    } = this.props;\n    // debugger\n    const file = e.file;\n    let reader = new FileReader();\n    reader.onload = e => {\n      let data = e.target.result;\n      let workbook = XLSX.read(data, {\n        type: 'binary'\n      });\n      if (tableOnImportItems) {\n        tableOnImportItems(workbook);\n      }\n    };\n    reader.readAsBinaryString(file);\n    migrateLeadCommons = (workbook, callback) => {\n      let sheet = workbook.Sheets.线索池;\n      if (!sheet) {\n        alert('sheet is null');\n        callback();\n        return;\n      }\n      let jsons = [];\n      let i = 12;\n      while (true) {\n        if (!sheet['A' + i] || sheet['A' + i] === '') break;\n        let json = {};\n        json.valid = 1;\n        if (sheet['A' + i]) json.name = sheet['A' + i].v;\n        if (sheet['B' + i]) json.company = sheet['B' + i].v;\n        if (sheet['C' + i]) json.dept = sheet['C' + i].v;\n        if (sheet['D' + i]) json.title = sheet['D' + i].v;\n        if (sheet['E' + i]) json.mobile = sheet['E' + i].v;\n        if (sheet['F' + i]) json.wechat = sheet['F' + i].v;\n        if (sheet['G' + i]) json.country = sheet['G' + i].v;\n        if (sheet['H' + i]) json.province = sheet['H' + i].v;\n        if (sheet['I' + i]) json.city = sheet['I' + i].v;\n        if (sheet['J' + i]) json.area = sheet['J' + i].v;\n        if (sheet['K' + i]) json.address = sheet['K' + i].v;\n        if (sheet['L' + i]) json.zipcode = sheet['L' + i].v;\n        if (sheet['M' + i]) json.comment = sheet['M' + i].v;\n        jsons.push(json);\n        i++;\n      }\n    };\n  };\n\n  //\t批量存储操作\n  ERPUtil.handleMultiObjects(jsons, this.createOneLeadCommon, {}, callback);\n}\n_c = App;\n;\ntableOnImportItems = workbook => {\n  this.migrateLeadCommons(workbook, data => {\n    this.showSuccessMessage('批量导入完成');\n  });\n  return /*#__PURE__*/_jsxDEV(Upload, {\n    onChange: e => {\n      this.onFileChange(e);\n    },\n    beforeUpload: () => false,\n    accept: '.xls, .xlsx',\n    children: /*#__PURE__*/_jsxDEV(Button, {\n      children: [/*#__PURE__*/_jsxDEV(Icon, {\n        type: \"download\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 19\n      }, this), tableImportBtnTxt]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 15\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 7\n  }, this);\n};\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","parse","useState","XLSX","moment","ReactDOM","Button","Table","Upload","Icon","App","onFileChange","e","tableOnImportItems","props","file","reader","FileReader","onload","data","target","result","workbook","read","type","readAsBinaryString","migrateLeadCommons","callback","sheet","Sheets","线索池","alert","jsons","i","json","valid","name","v","company","dept","title","mobile","wechat","country","province","city","area","address","zipcode","comment","push","ERPUtil","handleMultiObjects","createOneLeadCommon","showSuccessMessage","tableImportBtnTxt"],"sources":["D:/Users/lynnlam/Documents/GitHub/ui/world/src/App.js"],"sourcesContent":["import React from \"react\";\nimport parse from \"papaparse\";\nimport {useState} from 'react';\nimport * as XLSX from 'xlsx';\nimport moment from\"moment\";\nimport ReactDOM from 'react-dom';\nimport { Button, Table, Upload, Icon} from 'antd';\n\n\nfunction App() \n{    \n\n  onFileChange = (e) => {\n    const { tableOnImportItems } = this.props;\n    // debugger\n    const file = e.file;\n    let reader = new FileReader();\n    reader.onload = (e) => {\n        let data = e.target.result;\n        let workbook = XLSX.read(data, { type: 'binary' });\n        if (tableOnImportItems) {\n            tableOnImportItems(workbook);\n        }\n    };\n    reader.readAsBinaryString(file);\n    migrateLeadCommons = (workbook, callback) => {\n      let sheet = workbook.Sheets.线索池;\n      if (!sheet) {\n          alert('sheet is null');\n          callback();\n          return;\n      }\n\n      let jsons = [];\n      let i = 12;\n      while (true) {\n          if (!sheet['A' + i] || sheet['A' + i] === '') break;\n\n          let json = {};\n          json.valid = 1;\n          if (sheet['A' + i]) json.name = sheet['A' + i].v;\n          if (sheet['B' + i]) json.company = sheet['B' + i].v;\n          if (sheet['C' + i]) json.dept = sheet['C' + i].v;\n          if (sheet['D' + i]) json.title = sheet['D' + i].v;\n          if (sheet['E' + i]) json.mobile = sheet['E' + i].v;\n          if (sheet['F' + i]) json.wechat = sheet['F' + i].v;\n          if (sheet['G' + i]) json.country = sheet['G' + i].v;\n          if (sheet['H' + i]) json.province = sheet['H' + i].v;\n          if (sheet['I' + i]) json.city = sheet['I' + i].v;\n          if (sheet['J' + i]) json.area = sheet['J' + i].v;\n          if (sheet['K' + i]) json.address = sheet['K' + i].v;\n          if (sheet['L' + i]) json.zipcode = sheet['L' + i].v;\n          if (sheet['M' + i]) json.comment = sheet['M' + i].v;\n          jsons.push(json);\n          i++;\n      }\n    }\n  }\n\n//\t批量存储操作\n      ERPUtil.handleMultiObjects(jsons, this.createOneLeadCommon, {}, callback);\n  };\n  \n  tableOnImportItems = (workbook) => {\n      this.migrateLeadCommons(workbook, data => {\n          this.showSuccessMessage('批量导入完成')\n      });\n  \n    return (\n      <Upload\n      onChange={(e) => {\n                  this.onFileChange(e);\n              }}\n              beforeUpload={() => false}\n              accept={'.xls, .xlsx'}\n          >\n              <Button>\n                  <Icon type=\"download\" />{tableImportBtnTxt}\n              </Button>\n          </Upload>\n\n        );\n            }\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}